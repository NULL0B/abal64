//	------------------------------------------------------------------
//	Project		Web Navigator/Browser	for Amenesik / Sologic / Twin Server
//	------------------------------------------------------------------

#ifndef	_VGA_C
#define _VGA_C

static char	VgaPalette[256][4] = {

	0, 0, 0, 0, 		0, 0, 128, 0, 	 
	0, 128, 0, 0, 	 	0, 128, 128, 0, 
	128, 0, 0, 0, 		128, 0, 128, 0,  
	128, 128, 0, 0, 	128, 128, 128, 0, 
	192, 192, 192, 0,	0, 0, 255, 0, 
	0, 255, 0, 0, 		0, 255, 255, 0, 
	255, 0, 0, 0, 		255, 0, 255, 0, 
	255, 255, 0, 0, 	255, 255, 255, 0, 

	0x0006,	0x0006,	0x0006,	0x0000,
	0x0014,	0x0014,	0x0014,	0x0000,
	0x0020,	0x0020,	0x0020,	0x0000,
	0x002C,	0x002C,	0x002C,	0x0000,

	0x0038,	0x0038,	0x0038,	0x0000,
	0x0044,	0x0044,	0x0044,	0x0000,
	0x0050,	0x0050,	0x0050,	0x0000,
	0x0061,	0x0061,	0x0061,	0x0000,

	0x0071,	0x0071,	0x0071,	0x0000,
	0x0081,	0x0081,	0x0081,	0x0000,
	0x0091,	0x0091,	0x0091,	0x0000,
	0x00A1,	0x00A1,	0x00A1,	0x0000,

	0x00B6,	0x00B6,	0x00B6,	0x0000,
	0x00CA,	0x00CA,	0x00CA,	0x0000,
	0x00E2,	0x00E2,	0x00E2,	0x0000,
	0x00FF,	0x00FF,	0x00FF,	0x0000,

	0x0000,	0x0000,	0x00FF,	0x0000,
	0x0040,	0x0000,	0x00FF,	0x0000,
	0x007D,	0x0000,	0x00FF,	0x0000,
	0x00BE,	0x0000,	0x00FF,	0x0000,

	0x00FF,	0x0000,	0x00FF,	0x0000,
	0x00FF,	0x0000,	0x00BE,	0x0000,
	0x00FF,	0x0000,	0x007D,	0x0000,
	0x00FF,	0x0000,	0x0040,	0x0000,

	0x00FF,	0x0000,	0x0000,	0x0000,
	0x00FF,	0x0040,	0x0000,	0x0000,
	0x00FF,	0x007D,	0x0000,	0x0000,
	0x00FF,	0x00BE,	0x0000,	0x0000,

	0x00FF,	0x00FF,	0x0000,	0x0000,
	0x00BE,	0x00FF,	0x0000,	0x0000,
	0x007D,	0x00FF,	0x0000,	0x0000,
	0x0040,	0x00FF,	0x0000,	0x0000,

	0x0000,	0x00FF,	0x0000,	0x0000,
	0x0000,	0x00FF,	0x0040,	0x0000,
	0x0000,	0x00FF,	0x007D,	0x0000,
	0x0000,	0x00FF,	0x00BE,	0x0000,

	0x0000,	0x00FF,	0x00FF,	0x0000,
	0x0000,	0x00BE,	0x00FF,	0x0000,
	0x0000,	0x007D,	0x00FF,	0x0000,
	0x0000,	0x0040,	0x00FF,	0x0000,

	0x007D,	0x007D,	0x00FF,	0x0000,
	0x009D,	0x007D,	0x00FF,	0x0000,
	0x00BE,	0x007D,	0x00FF,	0x0000,
	0x00DE,	0x007D,	0x00FF,	0x0000,

	0x00FF,	0x007D,	0x00FF,	0x0000,
	0x00FF,	0x007D,	0x00DE,	0x0000,
	0x00FF,	0x007D,	0x00BE,	0x0000,
	0x00FF,	0x007D,	0x009D,	0x0000,

	0x00FF,	0x007D,	0x007D,	0x0000,
	0x00FF,	0x009D,	0x007D,	0x0000,
	0x00FF,	0x00BE,	0x007D,	0x0000,
	0x00FF,	0x00DE,	0x007D,	0x0000,

	0x00FF,	0x00FF,	0x007D,	0x0000,
	0x00DE,	0x00FF,	0x007D,	0x0000,
	0x00BE,	0x00FF,	0x007D,	0x0000,
	0x009D,	0x00FF,	0x007D,	0x0000,

	0x007D,	0x00FF,	0x007D,	0x0000,
	0x007D,	0x00FF,	0x009D,	0x0000,
	0x007D,	0x00FF,	0x00BE,	0x0000,
	0x007D,	0x00FF,	0x00DE,	0x0000,

	0x007D,	0x00FF,	0x00FF,	0x0000,
	0x007D,	0x00DE,	0x00FF,	0x0000,
	0x007D,	0x00BE,	0x00FF,	0x0000,
	0x007D,	0x009D,	0x00FF,	0x0000,

	0x00B6,	0x00B6,	0x00FF,	0x0000,
	0x00C6,	0x00B6,	0x00FF,	0x0000,
	0x00DA,	0x00B6,	0x00FF,	0x0000,
	0x00EA,	0x00B6,	0x00FF,	0x0000,

	0x00FF,	0x00B6,	0x00FF,	0x0000,
	0x00FF,	0x00B6,	0x00EA,	0x0000,
	0x00FF,	0x00B6,	0x00DA,	0x0000,
	0x00FF,	0x00B6,	0x00C6,	0x0000,

	0x00FF,	0x00B6,	0x00B6,	0x0000,
	0x00FF,	0x00C6,	0x00B6,	0x0000,
	0x00FF,	0x00DA,	0x00B6,	0x0000,
	0x00FF,	0x00EA,	0x00B6,	0x0000,

	0x00FF,	0x00FF,	0x00B6,	0x0000,
	0x00EA,	0x00FF,	0x00B6,	0x0000,
	0x00DA,	0x00FF,	0x00B6,	0x0000,
	0x00C6,	0x00FF,	0x00B6,	0x0000,

	0x00B6,	0x00FF,	0x00B6,	0x0000,
	0x00B6,	0x00FF,	0x00C6,	0x0000,
	0x00B6,	0x00FF,	0x00DA,	0x0000,
	0x00B6,	0x00FF,	0x00EA,	0x0000,

	0x00B6,	0x00FF,	0x00FF,	0x0000,
	0x00B6,	0x00EA,	0x00FF,	0x0000,
	0x00B6,	0x00DA,	0x00FF,	0x0000,
	0x00B6,	0x00C6,	0x00FF,	0x0000,

	0x0000,	0x0000,	0x0071,	0x0000,
	0x001C,	0x0000,	0x0071,	0x0000,
	0x0038,	0x0000,	0x0071,	0x0000,
	0x0055,	0x0000,	0x0071,	0x0000,

	0x0071,	0x0000,	0x0071,	0x0000,
	0x0071,	0x0000,	0x0055,	0x0000,
	0x0071,	0x0000,	0x0038,	0x0000,
	0x0071,	0x0000,	0x001C,	0x0000,

	0x0071,	0x0000,	0x0000,	0x0000,
	0x0071,	0x001C,	0x0000,	0x0000,
	0x0071,	0x0038,	0x0000,	0x0000,
	0x0071,	0x0055,	0x0000,	0x0000,

	0x0071,	0x0071,	0x0000,	0x0000,
	0x0055,	0x0071,	0x0000,	0x0000,
	0x0038,	0x0071,	0x0000,	0x0000,
	0x001C,	0x0071,	0x0000,	0x0000,

	0x0000,	0x0071,	0x0000,	0x0000,
	0x0000,	0x0071,	0x001C,	0x0000,
	0x0000,	0x0071,	0x0038,	0x0000,
	0x0000,	0x0071,	0x0055,	0x0000,

	0x0000,	0x0071,	0x0071,	0x0000,
	0x0000,	0x0055,	0x0071,	0x0000,
	0x0000,	0x0038,	0x0071,	0x0000,
	0x0000,	0x001C,	0x0071,	0x0000,

	0x0038,	0x0038,	0x0071,	0x0000,
	0x0044,	0x0038,	0x0071,	0x0000,
	0x0055,	0x0038,	0x0071,	0x0000,
	0x0061,	0x0038,	0x0071,	0x0000,

	0x0071,	0x0038,	0x0071,	0x0000,
	0x0071,	0x0038,	0x0061,	0x0000,
	0x0071,	0x0038,	0x0055,	0x0000,
	0x0071,	0x0038,	0x0044,	0x0000,

	0x0071,	0x0038,	0x0038,	0x0000,
	0x0071,	0x0044,	0x0038,	0x0000,
	0x0071,	0x0055,	0x0038,	0x0000,
	0x0071,	0x0061,	0x0038,	0x0000,

	0x0071,	0x0071,	0x0038,	0x0000,
	0x0061,	0x0071,	0x0038,	0x0000,
	0x0055,	0x0071,	0x0038,	0x0000,
	0x0044,	0x0071,	0x0038,	0x0000,

	0x0038,	0x0071,	0x0038,	0x0000,
	0x0038,	0x0071,	0x0044,	0x0000,
	0x0038,	0x0071,	0x0055,	0x0000,
	0x0038,	0x0071,	0x0061,	0x0000,

	0x0038,	0x0071,	0x0071,	0x0000,
	0x0038,	0x0061,	0x0071,	0x0000,
	0x0038,	0x0055,	0x0071,	0x0000,
	0x0038,	0x0044,	0x0071,	0x0000,

	0x0050,	0x0050,	0x0071,	0x0000,
	0x0059,	0x0050,	0x0071,	0x0000,
	0x0061,	0x0050,	0x0071,	0x0000,
	0x0069,	0x0050,	0x0071,	0x0000,

	0x0071,	0x0050,	0x0071,	0x0000,
	0x0071,	0x0050,	0x0069,	0x0000,
	0x0071,	0x0050,	0x0061,	0x0000,
	0x0071,	0x0050,	0x0059,	0x0000,

	0x0071,	0x0050,	0x0050,	0x0000,
	0x0071,	0x0059,	0x0050,	0x0000,
	0x0071,	0x0061,	0x0050,	0x0000,
	0x0071,	0x0069,	0x0050,	0x0000,

	0x0071,	0x0071,	0x0050,	0x0000,
	0x0069,	0x0071,	0x0050,	0x0000,
	0x0061,	0x0071,	0x0050,	0x0000,
	0x0059,	0x0071,	0x0050,	0x0000,

	0x0050,	0x0071,	0x0050,	0x0000,
	0x0050,	0x0071,	0x0059,	0x0000,
	0x0050,	0x0071,	0x0061,	0x0000,
	0x0050,	0x0071,	0x0069,	0x0000,

	0x0050,	0x0071,	0x0071,	0x0000,
	0x0050,	0x0069,	0x0071,	0x0000,
	0x0050,	0x0061,	0x0071,	0x0000,
	0x0050,	0x0059,	0x0071,	0x0000,

	0x0000,	0x0000,	0x0040,	0x0000,
	0x0010,	0x0000,	0x0040,	0x0000,
	0x0020,	0x0000,	0x0040,	0x0000,
	0x0030,	0x0000,	0x0040,	0x0000,

	0x0040,	0x0000,	0x0040,	0x0000,
	0x0040,	0x0000,	0x0030,	0x0000,
	0x0040,	0x0000,	0x0020,	0x0000,
	0x0040,	0x0000,	0x0010,	0x0000,

	0x0040,	0x0000,	0x0000,	0x0000,
	0x0040,	0x0010,	0x0000,	0x0000,
	0x0040,	0x0020,	0x0000,	0x0000,
	0x0040,	0x0030,	0x0000,	0x0000,

	0x0040,	0x0040,	0x0000,	0x0000,
	0x0030,	0x0040,	0x0000,	0x0000,
	0x0020,	0x0040,	0x0000,	0x0000,
	0x0010,	0x0040,	0x0000,	0x0000,

	0x0000,	0x0040,	0x0000,	0x0000,
	0x0000,	0x0040,	0x0010,	0x0000,
	0x0000,	0x0040,	0x0020,	0x0000,
	0x0000,	0x0040,	0x0030,	0x0000,

	0x0000,	0x0040,	0x0040,	0x0000,
	0x0000,	0x0030,	0x0040,	0x0000,
	0x0000,	0x0020,	0x0040,	0x0000,
	0x0000,	0x0010,	0x0040,	0x0000,

	0x0020,	0x0020,	0x0040,	0x0000,
	0x0028,	0x0020,	0x0040,	0x0000,
	0x0030,	0x0020,	0x0040,	0x0000,
	0x0038,	0x0020,	0x0040,	0x0000,

	0x0040,	0x0020,	0x0040,	0x0000,
	0x0040,	0x0020,	0x0038,	0x0000,
	0x0040,	0x0020,	0x0030,	0x0000,
	0x0040,	0x0020,	0x0028,	0x0000,

	0x0040,	0x0020,	0x0020,	0x0000,
	0x0040,	0x0028,	0x0020,	0x0000,
	0x0040,	0x0030,	0x0020,	0x0000,
	0x0040,	0x0038,	0x0020,	0x0000,

	0x0040,	0x0040,	0x0020,	0x0000,
	0x0038,	0x0040,	0x0020,	0x0000,
	0x0030,	0x0040,	0x0020,	0x0000,
	0x0028,	0x0040,	0x0020,	0x0000,

	0x0020,	0x0040,	0x0020,	0x0000,
	0x0020,	0x0040,	0x0028,	0x0000,
	0x0020,	0x0040,	0x0030,	0x0000,
	0x0020,	0x0040,	0x0038,	0x0000,

	0x0020,	0x0040,	0x0040,	0x0000,
	0x0020,	0x0038,	0x0040,	0x0000,
	0x0020,	0x0030,	0x0040,	0x0000,
	0x0020,	0x0028,	0x0040,	0x0000,

	0x002C,	0x002C,	0x0040,	0x0000,
	0x0030,	0x002C,	0x0040,	0x0000,
	0x0034,	0x002C,	0x0040,	0x0000,
	0x003C,	0x002C,	0x0040,	0x0000,

	0x0040,	0x002C,	0x0040,	0x0000,
	0x0040,	0x002C,	0x003C,	0x0000,
	0x0040,	0x002C,	0x0034,	0x0000,
	0x0040,	0x002C,	0x0030,	0x0000,

	0x0040,	0x002C,	0x002C,	0x0000,
	0x0040,	0x0030,	0x002C,	0x0000,
	0x0040,	0x0034,	0x002C,	0x0000,
	0x0040,	0x003C,	0x002C,	0x0000,

	0x0040,	0x0040,	0x002C,	0x0000,
	0x003C,	0x0040,	0x002C,	0x0000,
	0x0034,	0x0040,	0x002C,	0x0000,
	0x0030,	0x0040,	0x002C,	0x0000,

	0x002C,	0x0040,	0x002C,	0x0000,
	0x002C,	0x0040,	0x0030,	0x0000,
	0x002C,	0x0040,	0x0034,	0x0000,
	0x002C,	0x0040,	0x003C,	0x0000,

	0x002C,	0x0040,	0x0040,	0x0000,
	0x002C,	0x003C,	0x0040,	0x0000,
	0x002C,	0x0034,	0x0040,	0x0000,
	0x002C,	0x0030,	0x0040,	0x0000,

	0x0000,	0x0000,	0x0000,	0x0000,
	0x0000,	0x0000,	0x0000,	0x0000,
	0x0000,	0x0000,	0x0000,	0x0000,
	0x0000,	0x0000,	0x0000,	0x0000,

	0x0000,	0x0000,	0x0000,	0x0000,
	0x0000,	0x0000,	0x0000,	0x0000,
	0x0000,	0x0000,	0x0000,	0x0000,
	0x0000,	0x0000,	0x0000,	0x0000

	};

static char	*	vgapalette=(char *) &VgaPalette;
static	int		vgaindex=32;

void	set_palette_pointer( char * pptr )
{
	if ( pptr )
		vgapalette = pptr;
	else	vgapalette = (char *) &VgaPalette;
	return;
}


int	vga_application(int i, int  r, int  g, int  b )
{
	i += 32;
	if ( i > 255 )
		return(-1);
	else	{
		*(vgapalette+(i*4))   = r;
		*(vgapalette+(i*4)+1) = g;
		*(vgapalette+(i*4)+2) = b;
		return(i);
		}
}

int	vga_approximation(int  r, int  g, int  b )
{
	int	nr,ng,nb,ni;
	int	dr,dg,db,dt;
	int	pr,pg,pb;
	int	nt=255+255+255;
	short	i;

	// Detect a shade of Grey 
	// ----------------------
	if ((r == g)
	&&  (g == b)) {
		if (!(r)) return(r);
		for ( ni= 16; ni < 32; ni++ )
			if ( (*(vgapalette + (ni*4)) & 0x00FF) >= r)
				break;
		}
	else	{
		// Locate nearest colour
		// ---------------------
		for ( nt=255+255+255, ni=0, i = 0; i < 256; i++ ) {

			// Collect Palette Values
			// ----------------------
			pr = ( *(vgapalette+(i*4)) & 0x00FF);
			pg = ( *(vgapalette+(i*4)+1) & 0x00FF);
			pb = ( *(vgapalette+(i*4)+2) & 0x00FF);

			// Detect Exact Match and Return
			// -----------------------------
			if ((pr == r) &&  (pg == g) &&  (pb == b))
				return(i);

			// Calculate Total Differentiel
			if (pr > r) dr = pr-r; else dr = r-pr;
			if (pg > g) dg = pg-g; else dg = g-pg;
			if (pb > b) db = pb-b; else db = b-pb;
			dt = dr+dg+db;
			if ( dt < nt ) {
				ni = i;
				nt = dt;
				}
			}
		}
	return( ni );
}


#endif

